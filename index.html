<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Škodní protokol - Rohlik.cz</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🛡️ Záznam o škodní události</h1>
            <div class="header-subtitle">Digitální protokol pro rychlé a přesné hlášení</div>
        </div>

        <div class="company-info">
            <svg class="rohlik-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M5 15 C5 15, 8 12, 12 10 C14 9, 16 8.5, 18 9.5 C19.5 10.2, 20 11.5, 19.5 12.5 C19 13.5, 17.5 14, 16 13.5 C15 13, 14.5 12, 14 11.5 C13.5 11, 13 10.8, 12.5 11 C12 11.2, 11.5 11.8, 11 12.5 C10.5 13.2, 9.8 14, 8.5 14.8 C7.2 15.6, 5.8 16, 4.5 15.5 C3.8 15.2, 3.5 14.5, 4 13.8 Z" fill="#D4AF37"/>
                <path d="M5.5 14.5 C5.5 14.5, 8.5 11.8, 12 10 C13.8 9.2, 15.5 8.8, 17 9.5 C18.2 10, 18.5 11, 18 11.8 C17.5 12.6, 16.5 13, 15.5 12.8 C14.8 12.6, 14.3 12, 13.8 11.5 C13.3 11, 12.8 10.9, 12.4 11.1 C12 11.3, 11.6 11.8, 11.2 12.3 C10.8 12.8, 10.2 13.5, 9.2 14 C8.2 14.5, 7 14.8, 6 14.5 C5.3 14.3, 5.1 13.8, 5.5 13.2 Z" fill="#F4D03F"/>
                <path d="M6 14 C6 14, 9 11.5, 11.8 10.2 C13.2 9.5, 14.5 9.2, 15.5 9.6 C16.3 9.9, 16.5 10.5, 16.2 11 C15.9 11.5, 15.2 11.7, 14.5 11.5 C14 11.3, 13.7 10.9, 13.4 10.6 C13.1 10.3, 12.8 10.2, 12.6 10.3 C12.4 10.4, 12.2 10.7, 12 11 C11.8 11.3, 11.4 11.8, 10.8 12.1 C10.2 12.4, 9.5 12.5, 8.8 12.3 C8.3 12.1, 8.1 11.7, 8.3 11.3 Z" fill="#FFE4B5"/>
                <ellipse cx="10" cy="12" rx="0.3" ry="0.8" fill="#CD853F" opacity="0.6"/>
                <ellipse cx="12" cy="10.5" rx="0.3" ry="0.8" fill="#CD853F" opacity="0.6"/>
                <ellipse cx="14" cy="10" rx="0.3" ry="0.6" fill="#CD853F" opacity="0.6"/>
            </svg>
            Rohlik.cz
            <div class="sync-indicator" id="sync-indicator">
                🔄 Načítám aktuální ceny...
            </div>
        </div>

        <div class="progress-bar"></div>

        <div class="form-content">
            <!-- Kdy došlo k oznámení -->
            <div class="form-section">
                <div class="form-group">
                    <label class="main-label">⏰ 1. Kdy došlo k oznámení události</label>
                    <div class="current-time" id="current-time">
                        📅 Automaticky zaznamenáno: <span id="auto-time"></span>
                    </div>
                </div>
            </div>

            <!-- Kdy došlo k události -->
            <div class="form-section">
                <div class="form-group">
                    <label class="main-label">📋 2. Kdy došlo k události</label>
                    <div class="form-row">
                        <div class="form-col">
                            <label for="incident-date">📅 Datum</label>
                            <input type="date" id="incident-date" required>
                        </div>
                        <div class="form-col">
                            <label for="incident-time-input">🕐 Čas</label>
                            <input type="time" id="incident-time-input" required>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Kdo oznámil -->
            <div class="form-section">
                <div class="form-group">
                    <label class="main-label">👤 3. Kdo událost oznámil</label>
                    <div class="form-row">
                        <div class="form-col">
                            <label for="reporter-name">👨‍💼 Jméno a příjmení</label>
                            <input type="text" id="reporter-name" placeholder="Jméno a příjmení" required>
                        </div>
                        <div class="form-col">
                            <label for="reporter-position">💼 Pracovní pozice</label>
                            <input type="text" id="reporter-position" placeholder="Pracovní pozice" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-col">
                            <label for="reporter-id">🔢 Os. č.</label>
                            <input type="text" id="reporter-id" placeholder="Osobní číslo" required>
                        </div>
                        <div class="form-col">
                            <label for="reporter-company">🏢 Firma</label>
                            <input type="text" id="reporter-company" placeholder="Název firmy" required>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Kdo způsobil -->
            <div class="form-section">
                <div class="form-group">
                    <label class="main-label">⚠️ 4. Kdo událost způsobil</label>
                    <div class="form-row">
                        <div class="form-col">
                            <label for="perpetrator-name">👨‍💼 Jméno a příjmení</label>
                            <input type="text" id="perpetrator-name" placeholder="Jméno a příjmení" required>
                        </div>
                        <div class="form-col">
                            <label for="perpetrator-position">💼 Pracovní pozice</label>
                            <input type="text" id="perpetrator-position" placeholder="Pracovní pozice" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-col">
                            <label for="perpetrator-id">🔢 Os. č.</label>
                            <input type="text" id="perpetrator-id" placeholder="Osobní číslo" required>
                        </div>
                        <div class="form-col">
                            <label for="perpetrator-company">🏢 Firma</label>
                            <input type="text" id="perpetrator-company" placeholder="Název firmy" required>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Kde se stalo -->
            <div class="form-section">
                <div class="form-group">
                    <label class="main-label">📍 5. Kde k události došlo</label>
                    <select id="location" required>
                        <option value="">📍 Vyberte místo události...</option>
                        <option value="Trnkova 3118/119C, 628 00, Brno">🏢 Trnkova 3118/119C, 628 00, Brno</option>
                        <option value="Masná 27/9, 602 00, Brno">🏢 Masná 27/9, 602 00, Brno</option>
                    </select>
                    <input type="text" id="location-detail" placeholder="🎯 Přesné místo (hala, sekce, číslo regálu apod.)" style="margin-top: 15px;" required>
                </div>
            </div>

            <!-- Co bylo poškozeno -->
            <div class="form-section">
                <div class="form-group">
                    <label class="main-label">💥 6. Co bylo poškozeno</label>
                    <select id="damage-type" required onchange="autoFillPrice(this.value)">
                        <option value="">💥 Vyberte typ poškození...</option>
                        <option value="Dock leveler">⚖️ Dock leveler</option>
                        <option value="Dopravník">🔄 Dopravník</option>
                        <option value="Dveře">🚪 Dveře</option>
                        <option value="Elektroinstalace">⚡ Elektroinstalace</option>
                        <option value="Hala/střecha">🏭 Hala/střecha</option>
                        <option value="Vysokozdvižný vozík">⚙️ Vysokozdvižný vozík</option>
                        <option value="IT vybavení">💻 IT vybavení</option>
                        <option value="Kamerový systém">📹 Kamerový systém</option>
                        <option value="Klimatizace">❄️ Klimatizace</option>
                        <option value="Nakládací rampa">🚛 Nakládací rampa</option>
                        <option value="Ostatní">📋 Ostatní</option>
                        <option value="Paletizační stroj">🤖 Paletizační stroj</option>
                        <option value="Paletové regály">📚 Paletové regály</option>
                        <option value="Podlaha">🏢 Podlaha</option>
                        <option value="Požární zabezpečení">🚨 Požární zabezpečení</option>
                        <option value="Regál nosník">🔧 Regál nosník</option>
                        <option value="Regál police">📋 Regál police</option>
                        <option value="Regál stojina">🏗️ Regál stojina</option>
                        <option value="Sekční vrata">🚧 Sekční vrata</option>
                        <option value="Sprinklery">💧 Sprinklery</option>
                        <option value="Světelné systémy">💡 Světelné systémy</option>
                        <option value="Vozík / klec">🛒 Vozík / klec</option>
                        <option value="Zeď">🧱 Zeď</option>
                    </select>
                    <textarea id="damage-description" placeholder="📝 Stručný popis poškození..." style="margin-top: 15px;" required></textarea>
                </div>
            </div>

            <!-- Jak došlo k události -->
            <div class="form-section">
                <div class="form-group">
                    <label class="main-label">❓ 7. Jak došlo k události</label>
                    <select id="cause-type" required>
                        <option value="">❓ Vyberte příčinu...</option>
                        <option value="Nepozornost">😴 Nepozornost</option>
                        <option value="Nedbalost">🤷 Nedbalost</option>
                        <option value="Porušení BOZP">⚠️ Porušení BOZP</option>
                        <option value="Technická závada">🔧 Technická závada</option>
                    </select>
                </div>
            </div>

            <!-- Čím bylo způsobeno -->
            <div class="form-section page-break-before">
                <div class="form-group">
                    <label class="main-label">🔍 8. Čím bylo způsobeno</label>
                    <textarea id="cause-detail" placeholder="📋 Detailní popis příčiny události..." required></textarea>
                </div>
            </div>

            <!-- Odhadovaná škoda -->
            <div class="form-section">
                <div class="form-group">
                    <label class="main-label">💰 9. Odhadovaná škoda</label>
                    <div class="currency-group">
                        <input type="text" id="estimated-damage" placeholder="💲 Vyberte typ poškození pro automatické vyplnění" required>
                        <select id="currency">
                            <option value="CZK">🇨🇿 Kč</option>
                            <option value="EUR">🇪🇺 €</option>
                        </select>
                    </div>
                    <div id="auto-fill-indicator" style="display: none; background: linear-gradient(135deg, #fdcb6e 0%, #e17055 100%); color: white; padding: 12px; border-radius: 8px; margin-top: 10px; font-size: 14px; font-weight: 500;">
                        ✨ Automaticky vyplněno na základě průměrných cen
                    </div>
                </div>
            </div>

            <!-- Vyjádření viníka -->
            <div class="form-section">
                <div class="form-group">
                    <label class="main-label">💬 10. Vyjádření viníka</label>
                    <textarea id="perpetrator-statement" placeholder="💭 Vyjádření viníka k události..."></textarea>
                </div>
            </div>

            <!-- Nahrání fotek -->
            <div class="form-section">
                <div class="form-group">
                    <label class="main-label">📸 11. Nahrání fotografií (max. 4)</label>
                    <div class="photo-upload" onclick="document.getElementById('photos').click()">
                        <input type="file" id="photos" accept="image/*" multiple>
                        <button type="button" class="upload-btn">📷 Nahrát fotografie</button>
                        <p style="margin-top: 15px; color: #636e72; font-weight: 500;">📱 Klikněte pro výběr až 4 fotografií</p>
                        <div id="photo-preview" class="photo-preview"></div>
                    </div>
                </div>
            </div>

            <!-- Podpis viníka -->
            <div class="form-section">
                <div class="form-group">
                    <label class="main-label">✍️ 12. Podpis viníka *</label>
                    <div class="signature-section">
                        <canvas id="signature-perpetrator" class="signature-pad"></canvas>
                        <div class="signature-controls">
                            <button type="button" class="clear-btn" onclick="clearSignature('signature-perpetrator')">🗑️ Vymazat podpis</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Podpis security/vedoucího -->
            <div class="form-section">
                <div class="form-group">
                    <label class="main-label">✍️ 13. Podpis security / vedoucího *</label>
                    <div class="signature-section">
                        <canvas id="signature-supervisor" class="signature-pad"></canvas>
                        <div class="signature-controls">
                            <button type="button" class="clear-btn" onclick="clearSignature('signature-supervisor')">🗑️ Vymazat podpis</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="submit-section">
            <button type="button" class="submit-btn" onclick="submitForm()">
                🚀 Odeslat škodní protokol
            </button>
            <p style="margin-top: 15px; color: white; opacity: 0.8; font-size: 14px;">
                ✍️ POZOR: Oba podpisy jsou povinné pro odeslání protokolu!
            </p>
        </div>
    </div>

    <!-- Externí skripty -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="price-loader.js"></script>
    <script src="form-handler.js"></script>
    <script src="signature-handler.js"></script>
    <script src="photo-handler.js"></script>
    <script src="pdf-generator.js"></script>

    <style>
        .sync-indicator {
            position: absolute;
            top: 10px;
            right: 20px;
            background: rgba(0, 0, 0, 0.2);
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 500;
        }

        .sync-indicator.success {
            background: rgba(39, 174, 96, 0.8);
        }

        .sync-indicator.error {
            background: rgba(231, 76, 60, 0.8);
        }

        .company-info {
            position: relative;
        }

        /* Všechny původní styly zůstávají stejné */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            line-height: 1.6;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.15);
            overflow: hidden;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .header {
            background: linear-gradient(135deg, #00c851 0%, #ff6900 100%);
            color: white;
            padding: 30px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .header h1 {
            font-size: 28px;
            margin-bottom: 10px;
            position: relative;
            z-index: 1;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header-subtitle {
            font-size: 16px;
            opacity: 0.9;
            position: relative;
            z-index: 1;
        }

        .company-info {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            padding: 25px;
            text-align: center;
            border-bottom: 3px solid #00c851;
            font-size: 24px;
            font-weight: bold;
            color: #2d3436;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
        }

        .rohlik-icon {
            width: 32px;
            height: 32px;
            display: inline-block;
        }

        .progress-bar {
            height: 6px;
            background: linear-gradient(90deg, #00c851 0%, #ff6900 100%);
            margin-bottom: 20px;
            border-radius: 3px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .form-content {
            padding: 40px;
            background: linear-gradient(180deg, #ffffff 0%, #f8f9fa 100%);
        }

        .form-section {
            background: white;
            margin-bottom: 30px;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.08);
            border: 1px solid rgba(0,0,0,0.05);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .form-section:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 35px rgba(0,0,0,0.12);
        }

        .form-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #00c851 0%, #ff6900 100%);
        }

        .form-group {
            margin-bottom: 25px;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }

        .form-col {
            display: flex;
            flex-direction: column;
        }

        label {
            display: block;
            margin-bottom: 10px;
            font-weight: 600;
            color: #2d3436;
            font-size: 14px;
            letter-spacing: 0.3px;
        }

        .main-label {
            font-size: 18px;
            margin-bottom: 20px;
            color: #2d3436;
            display: flex;
            align-items: center;
            font-weight: 700;
        }

        input[type="text"],
        input[type="date"],
        input[type="time"],
        select,
        textarea {
            width: 100%;
            padding: 15px;
            border: 2px solid #e9ecef;
            border-radius: 10px;
            font-size: 16px;
            transition: all 0.3s ease;
            background: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(5px);
        }

        input[type="text"]:focus,
        input[type="date"]:focus,
        input[type="time"]:focus,
        select:focus,
        textarea:focus {
            outline: none;
            border-color: #00c851;
            box-shadow: 0 0 0 4px rgba(0, 200, 81, 0.1);
            background: white;
            transform: translateY(-1px);
        }

        textarea {
            min-height: 120px;
            resize: vertical;
            font-family: inherit;
        }

        .current-time {
            background: linear-gradient(135deg, #74b9ff 0%, #0984e3 100%);
            color: white;
            padding: 20px;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            box-shadow: 0 8px 25px rgba(116, 185, 255, 0.3);
            text-align: center;
        }

        .currency-group {
            display: flex;
            align-items: center;
            gap: 15px;
            background: white;
            border-radius: 10px;
            padding: 5px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
        }

        .currency-group input {
            border: none;
            background: transparent;
            flex: 1;
        }

        .currency-group select {
            width: 80px;
            border: none;
            background: #f8f9fa;
            border-radius: 8px;
        }

        .submit-section {
            background: linear-gradient(135deg, #2d3436 0%, #636e72 100%);
            padding: 40px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .submit-btn {
            background: linear-gradient(135deg, #00c851 0%, #ff6900 100%);
            color: white;
            padding: 20px 50px;
            border: none;
            border-radius: 30px;
            font-size: 20px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 10px 30px rgba(0, 200, 81, 0.3);
            position: relative;
            z-index: 1;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .submit-btn:hover {
            transform: translateY(-3px) scale(1.05);
            box-shadow: 0 15px 40px rgba(0, 200, 81, 0.4);
        }

        .photo-upload {
            border: 3px dashed #00c851;
            border-radius: 15px;
            padding: 40px;
            text-align: center;
            background: linear-gradient(135deg, rgba(0, 200, 81, 0.05) 0%, rgba(255, 105, 0, 0.05) 100%);
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }

        .photo-upload:hover {
            border-color: #ff6900;
            background: linear-gradient(135deg, rgba(0, 200, 81, 0.1) 0%, rgba(255, 105, 0, 0.1) 100%);
            transform: scale(1.02);
        }

        .photo-upload input[type="file"] {
            display: none;
        }

        .upload-btn {
            background: linear-gradient(135deg, #00c851 0%, #ff6900 100%);
            color: white;
            padding: 15px 30px;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 200, 81, 0.3);
        }

        .upload-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 200, 81, 0.4);
        }

        .signature-section {
            border: 2px solid #e9ecef;
            border-radius: 15px;
            padding: 25px;
            background: linear-gradient(135deg, #f8f9fa 0%, #ffffff 100%);
            box-shadow: inset 0 2px 10px rgba(0,0,0,0.05);
        }

        .signature-pad {
            width: 100%;
            height: 180px;
            border: 2px solid #dee2e6;
            border-radius: 10px;
            background: white;
            cursor: crosshair;
            box-shadow: inset 0 2px 5px rgba(0,0,0,0.05);
            transition: border-color 0.3s ease;
        }

        .signature-pad:hover {
            border-color: #00c851;
        }

        .signature-controls {
            margin-top: 15px;
            text-align: center;
        }

        .clear-btn {
            background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 20px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(231, 76, 60, 0.3);
        }

        .clear-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 6px 20px rgba(231, 76, 60, 0.4);
        }

        .photo-preview {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
            margin-top: 20px;
        }

        .photo-preview img {
            width: 120px;
            height: 120px;
            object-fit: cover;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            transition: transform 0.3s ease;
        }

        .photo-preview img:hover {
            transform: scale(1.1);
        }

        @media (max-width: 768px) {
            .form-row {
                grid-template-columns: 1fr;
                gap: 15px;
            }
            
            body {
                padding: 10px;
            }
            
            .form-content {
                padding: 25px;
            }

            .form-section {
                padding: 20px;
            }

            .header h1 {
                font-size: 24px;
            }

            .submit-btn {
                padding: 15px 30px;
                font-size: 18px;
            }
        }

        .loading {
            opacity: 0.7;
            pointer-events: none;
        }

        .success-animation {
            animation: successPulse 0.6s ease-in-out;
        }

        @keyframes successPulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
    </style>
</body>
</html>
